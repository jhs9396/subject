<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>no force</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.1/d3.min.js"></script>
    <style>
        html, body, #container {
            width: 100%;
            height: 100%;
        }
    </style>

</head>
<body>

<div id="container">
    <svg width="100%" height="100%">
        <g class="main"  transform="translate(450,300)"  >
            <g class="edgesGrp"></g>

            <g class="vertexGrp"></g>
        </g>
    </svg>
</div>
</body>
<script>
    let color = d3.scaleOrdinal(d3.schemeCategory10)
    let force01 = d3.forceSimulation();
    // force01.stop()


    let centerForce = d3.forceCenter(400,300)
    let radialForce  = d3.forceRadial()
    radialForce.radius(d=>20+d.group*25)

    let collisionForce = d3.forceCollide();
    collisionForce.radius(5)


    // force01.force('center',centerForce)
    force01.force('center',radialForce  )
    force01.force('collision',collisionForce)


    window.addEventListener('load',()=>{
        force01.on('tick', tickFunc)

        d3.json('../data/miserables.json').then(json=>{
            console.log('json', json)

            force01.nodes(json.nodes, d=>d.id)

            // tickFunc()

        })
    })


    function tickFunc() {
        let vertexSelection = d3.select('.vertexGrp').selectAll('circle').data(force01.nodes())
        vertexSelection.enter().append('circle')
            .attr('cx',d=>d.x)
            .attr('cy',d=>d.y)
            .attr('fill',d=>color(d.group))
            .attr('r',5)


        vertexSelection
            .attr('cx',d=>d.x)
            .attr('cy',d=>d.y)
    }


    document.getElementsByTagName('body')[0].addEventListener('click',(evt)=>{
        console.log('s',evt)

        radialForce.x(evt.clientX )
        radialForce.y(evt.clientY )
        force01.stop()
        force01.alpha(1)
        force01.restart()
    })

</script>
</html>